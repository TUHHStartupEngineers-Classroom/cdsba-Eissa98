{
  "hash": "9678999f6fa08d6ff4ed0f1b47462bf8",
  "result": {
    "markdown": "---\ntitle: \"Regression Discontinuity\"\n---\n\n\n::: callout-note\nYou can delete everything in here and start fresh.\n:::\n\n::: {.cell hash='10_rdd_cache/html/unnamed-chunk-1_b722ac1576c22b31091846bb4af85882'}\n\n```{.r .cell-code}\ncoupon_data<- readRDS(\"D:/TU Hamburg/Semester_5/Causal Data Science for Business Analytics/Causal_Data_Science_Data/Causal_Data_Science_Data/coupon.rds\")\n\nView(coupon_data)\n```\n:::\n\n::: {.cell hash='10_rdd_cache/html/unnamed-chunk-2_232a03121e555f4035b342f5046a8ebd'}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> The following objects are masked from 'package:stats':\n#> \n#>     filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> The following objects are masked from 'package:base':\n#> \n#>     intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nc0 <- 60\n\nbw <- 5\n\nbw1 <- c0 + c(-bw/2, bw/2)\n\nbw2 <- c0 + c(-bw*2,bw*2)\n\nbw1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 57.5 62.5\n```\n:::\n\n```{.r .cell-code}\nbw2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 50 70\n```\n:::\n\n```{.r .cell-code}\ndf_bw1_below <- coupon_data %>% filter(days_since_last >= bw1[1] & days_since_last < c0)\ndf_bw1_above <- coupon_data %>% filter(days_since_last >= c0 & days_since_last <= bw1[2])\n\ndf_bw2_below <- coupon_data %>% filter(days_since_last >= bw2[1] & days_since_last < c0)\ndf_bw2_above <- coupon_data %>% filter(days_since_last >= c0 & days_since_last <= bw2[2])\n\n\ndf_bw1 <- bind_rows(df_bw1_above, df_bw1_below)\n\ndf_bw2 <- bind_rows(df_bw2_above, df_bw2_below)\n\nmodel_bw1_below <- lm(purchase_after ~ days_since_last, data = df_bw1_below)\nmodel_bw1_above <- lm(purchase_after ~ days_since_last, data = df_bw1_above)\n\nmodel_bw2_below <- lm(purchase_after ~ days_since_last, df_bw2_below)\nmodel_bw2_above <- lm(purchase_after ~ days_since_last, df_bw2_above)\n\ny_b1_0 <- predict(model_bw1_below, tibble(days_since_last = c0))\ny_b1_1 <- predict(model_bw1_above, tibble(days_since_last = c0))\n\nlate_b1<-y_b1_1 - y_b1_0\n\ny_b2_0 <- predict(model_bw2_below, tibble(days_since_last = c0))\ny_b2_1 <- predict(model_bw2_above, tibble(days_since_last = c0))\n\nlate_b2<- y_b2_1 - y_b2_0\n\nsprintf(\"LATE1: %.2f\", late_b1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"LATE1: 7.36\"\n```\n:::\n\n```{.r .cell-code}\nsprintf(\"LATE2: %.2f\", late_b2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"LATE2: 9.51\"\n```\n:::\n:::\n\n::: {.cell hash='10_rdd_cache/html/unnamed-chunk-3_66bbcc0900f8b8b523b60a9f29eee667'}\n\n```{.r .cell-code}\nshipping_data<- readRDS(\"D:/TU Hamburg/Semester_5/Causal Data Science for Business Analytics/Causal_Data_Science_Data/Causal_Data_Science_Data/shipping.rds\")\n\nView(shipping_data)\n```\n:::\n\n::: {.cell hash='10_rdd_cache/html/unnamed-chunk-4_ba2bfd66504d08e42584dad2b5e1c76c'}\n\n```{.r .cell-code}\nlibrary(rddensity)\n\nc1 = 30\n\nrddd <- rddensity(shipping_data$purchase_amount, c = c1)\nsummary(rddd)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Manipulation testing using local polynomial density estimation.\n#> \n#> Number of obs =       6666\n#> Model =               unrestricted\n#> Kernel =              triangular\n#> BW method =           estimated\n#> VCE method =          jackknife\n#> \n#> c = 30                Left of c           Right of c          \n#> Number of obs         3088                3578                \n#> Eff. Number of obs    2221                1955                \n#> Order est. (p)        2                   2                   \n#> Order bias (q)        3                   3                   \n#> BW est. (h)           22.909              20.394              \n#> \n#> Method                T                   P > |T|             \n#> Robust                5.9855              0\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning in summary.CJMrddensity(rddd): There are repeated observations. Point\n#> estimates and standard errors have been adjusted. Use option massPoints=FALSE\n#> to suppress this feature.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> P-values of binomial tests (H0: p=0.5).\n#> \n#> Window Length / 2          <c     >=c    P>|T|\n#> 0.261                      20      26    0.4614\n#> 0.522                      41      65    0.0250\n#> 0.783                      62     107    0.0007\n#> 1.043                      81     136    0.0002\n#> 1.304                     100     169    0.0000\n#> 1.565                     114     196    0.0000\n#> 1.826                     132     227    0.0000\n#> 2.087                     156     263    0.0000\n#> 2.348                     173     298    0.0000\n#> 2.609                     191     331    0.0000\n```\n:::\n:::\n\n::: {.cell hash='10_rdd_cache/html/unnamed-chunk-5_33240c7f1fb65183d78eec0c36f5d1d4'}\n\n```{.r .cell-code}\nrdd_plot <- rdplotdensity(rddd, shipping_data$purchase_amount, plotN = 100)\n```\n\n::: {.cell-output-display}\n![](10_rdd_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n3- No the cut-off = 30 euros is not appropriate choice as the P-value is zero which is larger than any common alpha. Furthermore, according to the graph this cut-off value violates the continuity assumption as a random heaping appeared at this cut-off value.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}